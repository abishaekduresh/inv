# ğŸ§¾ Changelog

All notable changes to this project will be documented in this file.

---

## [v2.0] - 2025-10-28

### ğŸš€ Added

#### ğŸ§© Dashboard Enhancements

- Introduced **dynamic business dashboard** powered by Chart.js and Bootstrap.
- Added **real-time metrics API** for invoices, sales, business, and logs.
- Integrated **bar and line charts** for last 7-day invoice and sales tracking.
- Dashboard now caches data in **sessionStorage** for faster loading and offline view.
- Added **manual refresh** option to fetch live updates from the API.
- Added **responsive recent invoices cards** with count indicator and hover effects.
- Introduced **pagination** support for dashboard data (recent invoices).

#### ğŸ§¾ Activity Log Module

- Added new endpoint for **activity log fetching with pagination** and search.
- Integrated **Bootstrap table** UI for viewing logs with:
  - Search
  - Sort order (ASC/DESC)
  - Pagination controls
  - Record count display
- Added **JSON export** feature for logs.
- Implemented **debounced search** for improved UX.
- Created `fetchActivityLogs()` model method with proper pagination response.

#### âš™ï¸ Backend Improvements

- Enhanced **`fetchDashboardStats()`** method:
  - Real pagination support for recent invoices
  - Added `last7Days` analytics dataset for Chart.js
  - Unified data response with `data[]` and `pagination` block
- Improved `ActivityLoggerMiddleware` to log user actions, endpoints, and IP addresses.
- Added **error handling and standard JSON responses** for consistency.

#### ğŸ’… UI/UX Enhancements

- Fully Bootstrap 5-based dashboard & settings pages.
- Added responsive **settings card** layout with logo upload preview.
- Implemented **SweetAlert2 toasts** for all success/error actions.
- Enhanced typography, spacing, and iconography consistency.
- Added refresh and export buttons with loading animations.

---

## ğŸ“˜ API Reference

### ğŸ”¹ Dashboard Endpoint

```http
GET /api/business/stats
```

**Description:** Returns aggregated business statistics, recent invoices, and last 7-day chart data.

#### Response Format

```json
{
  "status": true,
  "message": "Dashboard stats fetched successfully.",
  "data": [
    {
      "totalInvoices": 2027,
      "todayInvoices": 1,
      "yesterdayInvoices": 1,
      "totalBusiness": 1,
      "totalSales": "6,204,884.50",
      "todaySales": "10.00",
      "yesterdaySales": "10.00",
      "totalLogs": 636,
      "recentInvoices": [...],
      "last7Days": {
        "labels": ["Wed","Thu","Fri","Sat","Sun","Mon","Tue"],
        "invoices": [0,0,0,0,0,1,1],
        "sales": [0,0,0,0,0,10,10]
      }
    }
  ],
  "pagination": {
    "currentPage": 1,
    "limit": 6,
    "totalPages": 338,
    "totalRecords": 2027
  }
}
```

---

### ğŸ”¹ Activity Logs Endpoint

```http
GET /api/business/activity/log
```

| Parameter | Type    | Description                                          |
| --------- | ------- | ---------------------------------------------------- |
| `q`       | string  | Search query across action, endpoint, user ID, or IP |
| `id`      | string  | Filter logs by business ID                           |
| `ord`     | string  | Order direction (`ASC` or `DESC`)                    |
| `page`    | integer | Pagination page number                               |
| `limit`   | integer | Number of records per page                           |

#### Example Response

```json
{
  "status": true,
  "message": "Activity logs fetched successfully.",
  "data": {
    "records": [
      {
        "userId": "95ABF2FD67AE",
        "businessId": "B3E531BB14BC",
        "action": "Activity logs fetched successfully.",
        "ipAddress": "::1",
        "createdAtText": "2025-10-28 12:29:49"
      }
    ]
  },
  "pagination": {
    "currentPage": 1,
    "limit": 25,
    "totalPages": 660,
    "totalRecords": 660
  }
}
```

---

### ğŸ Fixed

- Fixed redirect issues on SiteGround hosting.

---

> **Last updated:** 2025-10-28  
> **Maintainer:** Abishaek Duresh B  
> ğŸ“§ abishaekduresh@gmail.com  
> ğŸŒ https://abishaek.com
